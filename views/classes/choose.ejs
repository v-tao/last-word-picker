<% include ../partials/header %>
<div class="container">
	<h1>
		Pick the Last Word
	</h1>
	<button class="btn btn-dark" id="choose">
		Choose
	</button>
	<audio id="drumroll">
            <source src="/assets/audio/drum_roll1.mp3" type="audio/mpeg"> 
    </audio>
	<div id="content">
	<h1 id="loading" class="mt-3">
		
	</h1>
	</div>
	<a href="/classes/<%=selectedClass._id%>/">Back</a>
</div>

<script>
	var drumroll = document.querySelector("#drumroll");
	function choose(){
		<% var randomPerson = Math.floor(Math.random() * selectedClass.students.length)%>
	}
	
	function reset() {
		$("#student-name").remove();
	}
	
	function load() {
    $("#loading").text("DRUMROLL PLEASE");
    for(i = 1; i < 4; i++){
        setTimeout(function(){
            $("#loading").append(".");
        }, 500 * i);
    }
	}
	
	$("#choose").on("click", function(){
	choose();
	drumroll.pause();
    drumroll.currentTime = 0;
    $("#loading").css("display", "block");
    $("#loading").text("DRUMROLL PLEASE");
    drumroll.play();
    for(i = 1; i < 4; i++){
        setTimeout(function(){
            load();
        }, 2000 * i)
    }
    load();
    setTimeout(function(){
        loading.style.display = "none";
        $("#content").append("<h2 class='mt-3' id='student-name'><%=selectedClass.students[randomPerson].name%></h2>")
    }, 6900);
    reset();	
	})
</script>
<% include ../partials/footer %>